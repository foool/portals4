<?xml version="1.0"?>
<test>
  
  <subtest>
    <desc>Test put me</desc>
    <ptl>
      <ptl_ni ni_opt="MATCH PHYSICAL">
        <ptl_eq>
          <ptl_pt>
            <ptl_me_append me_opt="OP_PUT">
              <ptl_md>
                <ptl_put target_id="SELF"/>
                <ptl_eq_wait>
                  <check event_type="LINK"/>
                </ptl_eq_wait>
                <ptl_eq_wait>
                  <check event_type="PUT"/>
                </ptl_eq_wait>
                <ptl_eq_wait>
                  <check event_type="SEND"/>
                </ptl_eq_wait>
                <msleep time="50"/>
                <ptl_eq_get ret="EQ_EMPTY"/>
              </ptl_md>
              <ptl_me_unlink/>
            </ptl_me_append>
          </ptl_pt>
        </ptl_eq>
      </ptl_ni>
    </ptl>
  </subtest>
  
  <subtest>
    <desc>Test put me with ack</desc>
    <ptl>
      <ptl_ni ni_opt="MATCH PHYSICAL">
        <ompi_rt>
          <ptl_eq>
            <ptl_pt>
              <ptl_me_append me_opt="OP_PUT">
                <ptl_md>
                  <ptl_put target_id="SELF" ack_req="ACK"/>
                  <ptl_eq_wait>
                    <check event_type="LINK"/>
                  </ptl_eq_wait>
                  <ptl_eq_wait>
                    <check event_type="PUT"/>
                  </ptl_eq_wait>
                  <ptl_eq_wait>
                    <check event_type="SEND"/>
                  </ptl_eq_wait>
                  <ptl_eq_wait>
                    <check event_type="ACK"/>
                  </ptl_eq_wait>
                  <msleep time="50"/>
                  <ptl_eq_get ret="EQ_EMPTY"/>
                </ptl_md>
                <ptl_me_unlink/>
              </ptl_me_append>
            </ptl_pt>
          </ptl_eq>
        </ompi_rt>
      </ptl_ni>
    </ptl>
  </subtest>
  
  <subtest>
    <desc>Test put me with ack disabled</desc>
    <ptl>
      <ptl_ni ni_opt="MATCH PHYSICAL">
        <ompi_rt>
          <ptl_eq>
            <ptl_pt>
              <ptl_me_append me_opt="OP_PUT ACK_DISABLE">
                <ptl_md>
                  <ptl_put target_id="SELF" ack_req="ACK"/>
                  <ptl_eq_wait>
                    <check event_type="LINK"/>
                  </ptl_eq_wait>
                  <ptl_eq_wait>
                    <check event_type="PUT"/>
                  </ptl_eq_wait>
                  <ptl_eq_wait>
                    <check event_type="SEND"/>
                  </ptl_eq_wait>
                  <msleep time="50"/>
                  <ptl_eq_get ret="EQ_EMPTY"/>
                </ptl_md>
                <ptl_me_unlink/>
              </ptl_me_append>
            </ptl_pt>
          </ptl_eq>
        </ompi_rt>
      </ptl_ni>
    </ptl>
  </subtest>
  
</test>

